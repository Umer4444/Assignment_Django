{% extends 'basic.html' %}
{% load static %}
{% block title %} Submit {% endblock title %}
{% load widget_tweaks %}
{% block body %}

<main>
    <section class="mb-5">
        <div class="container">
            <div class="submitform mt-5">
                <h3 class="text-center">Signup or login to submit your assignment</h3>
                <div class="orderquestion">
                    <div class="orderquestion__heading">
                        <p>
                            Fill in the order form to get the price
                        </p>
                    </div>
                    <div class="orderquestion__body text-center">
                        <form method="POST" enctype="multipart/form-data" action="{% url 'signup' %}">
                            {% csrf_token %}
                            <div class="col-lg-12">
                                <div class="row align-items-center">
                                    <div class="col-lg-3 col-md-3">
                                        <label class="float__res" for="">Subject</label>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        {{ form.category|add_class:"float__l width2-100" }}
                                        <p id="category-validation-error" class="error-text" style="display: none;">
                                            Please fill out this field.</p>
                                        <script>
                                            document.addEventListener("DOMContentLoaded", function () {
                                                var input = document.querySelector("[name='category']");
                                                var errorMessage = document.getElementById("category-validation-error");

                                                input.setAttribute("required", "required");

                                                input.addEventListener("invalid", function (event) {
                                                    event.preventDefault();
                                                    errorMessage.style.display = "block";
                                                });

                                                input.addEventListener("input", function () {
                                                    errorMessage.style.display = "none";
                                                });
                                            });
                                        </script>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 mt-3">
                                <div class="row align-items-center">
                                    <div class="col-lg-3 col-md-3">
                                        <label class="float__res" for="">Deadline</label>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        <input type="datetime-local" name="deadline" class="float__l" id="id_deadline"
                                            required>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 mt-3">
                                <div class="row align-items-center">
                                    <div class="col-lg-3 col-md-3">
                                        <label class="float__res" for="">Title</label>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        {{ form.title|add_class:"float__l width2-100" }}
                                        <p id="title-validation-error" class="error-text" style="display: none;">Please
                                            fill out this field.</p>
                                        <script>
                                            document.addEventListener("DOMContentLoaded", function () {
                                                var input = document.querySelector("[name='title']");
                                                var errorMessage = document.getElementById("title-validation-error");

                                                input.setAttribute("required", "required");

                                                input.addEventListener("invalid", function (event) {
                                                    event.preventDefault();
                                                    errorMessage.style.display = "block";
                                                });

                                                input.addEventListener("input", function () {
                                                    errorMessage.style.display = "none";
                                                });
                                            });
                                        </script>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 mt-3">
                                <div class="row align-items-center">
                                    <div class="col-lg-3 col-md-3">
                                        <label class="float__res" for="">Task</label>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        {{ form.task|add_class:"width2-100 float__l" }}
                                        <p id="task-validation-error" class="error-text" style="display: none;">Please
                                            fill out this field.</p>
                                        <script>
                                            document.addEventListener("DOMContentLoaded", function () {
                                                var input = document.querySelector("[name='task']");
                                                var errorMessage = document.getElementById("task-validation-error");

                                                input.setAttribute("required", "required");

                                                input.addEventListener("invalid", function (event) {
                                                    event.preventDefault();
                                                    errorMessage.style.display = "block";
                                                });

                                                input.addEventListener("input", function () {
                                                    errorMessage.style.display = "none";
                                                });
                                            });
                                        </script>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 mt-3 mb-3">
                                <div class="row align-items-center">
                                    <div class="col-lg-3 col-md-3">
                                        <label class="float__res" for="">Special <br> Requirements</label>
                                    </div>
                                    <div class="col-lg-9 col-md-9">
                                        {{ form.special_requirement|add_class:"width2-100 float__l" }}
                                        <p id="special-requirement-validation-error" class="error-text"
                                            style="display: none;">Please fill out this field.</p>
                                        <script>
                                            document.addEventListener("DOMContentLoaded", function () {
                                                var input = document.querySelector("[name='special_requirement']");
                                                var errorMessage = document.getElementById("special-requirement-validation-error");

                                                input.setAttribute("required", "required");

                                                input.addEventListener("invalid", function (event) {
                                                    event.preventDefault();
                                                    errorMessage.style.display = "block";
                                                });

                                                input.addEventListener("input", function () {
                                                    errorMessage.style.display = "none";
                                                });
                                            });
                                        </script>
                                    </div>
                                </div>
                            </div>
                            <div class="upload">
                                <div class="upload__head">
                                    <p>
                                        Upload files (if required)
                                    </p>
                                </div>
                                <div class="upload__body">
                                    <!-- <div id="dropzone" ondragover="event.preventDefault()" ondrop="handleDrop(event)">
                                        <p>Drag and drop files here</p>
                                    </div> -->
                                    <div class="mt-3 mb-3">
                                        {{ form.file.errors }}
                                        <label for="{{ form.file.id_for_label }}">Add Files</label>

                                        <input class="form-control" type="file" id="fileInput" name="file" required>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-secondary">SUBMIT</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>

<script>
    function handleDrop(event) {
        event.preventDefault();
        var files = event.dataTransfer.files;
        document.getElementById('fileInput').files = files;
        handleFiles(files);
    }

    function handleFiles(files) {
        var fileNames = [];
        for (var i = 0; i < files.length; i++) {
            var file = files[i];
            fileNames.push(file.name);
        }
        document.getElementById('selectedFiles').value = fileNames.join(', ');
    }
</script>
{% endblock body %}